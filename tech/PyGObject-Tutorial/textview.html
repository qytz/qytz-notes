

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multiline Text Editor &mdash; qytz-notes v0.1</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/fix_rtd_width.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="author" title="关于这些文档" href="../../about.html" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="菜单" href="menus.html" />
    <link rel="prev" title="IconView" href="iconview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> qytz-notes
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Python笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code/index.html">开源代码阅读笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ipynb/index.html">IPython NoteBooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">技术笔记</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">The Python GTK+ 3 Tutorial</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install.html">安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="introduction.html">从零开始</a></li>
<li class="toctree-l3"><a class="reference internal" href="basics.html">基础知识</a></li>
<li class="toctree-l3"><a class="reference internal" href="unicode.html">处理字符串相关问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="layout.html">布局管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="label.html">标签Label</a></li>
<li class="toctree-l3"><a class="reference internal" href="entry.html">Entry输入框</a></li>
<li class="toctree-l3"><a class="reference internal" href="button_widgets.html">按钮控件</a></li>
<li class="toctree-l3"><a class="reference internal" href="progressbar.html">进度条</a></li>
<li class="toctree-l3"><a class="reference internal" href="spinner.html">Spinner</a></li>
<li class="toctree-l3"><a class="reference internal" href="treeview.html">树与列表控件</a></li>
<li class="toctree-l3"><a class="reference internal" href="cellrenderers.html">单元格渲染器（CellRenderers）</a></li>
<li class="toctree-l3"><a class="reference internal" href="combobox.html">组合框（ComboBox）</a></li>
<li class="toctree-l3"><a class="reference internal" href="iconview.html">IconView</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Multiline Text Editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="menus.html">菜单</a></li>
<li class="toctree-l3"><a class="reference internal" href="dialogs.html">对话框（Dialog）</a></li>
<li class="toctree-l3"><a class="reference internal" href="clipboard.html">剪贴板</a></li>
<li class="toctree-l3"><a class="reference internal" href="drag_and_drop.html">拖拽支持</a></li>
<li class="toctree-l3"><a class="reference internal" href="builder.html">Glade and Gtk.Builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects.html">对象系统</a></li>
<li class="toctree-l3"><a class="reference internal" href="stock.html">Stock Items</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gstreamer/index.html">GStreamer 开发经验</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pycairo/index.html">Pycairo Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbus/index.html">D-Bus 使用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell-tutorial.html">shell 脚本常用操作入门</a></li>
<li class="toctree-l2"><a class="reference internal" href="../js-bit-operate.html">JavaScript 的移位运算与 IP 地址处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto-make-conf.html">automake 和 autoconf 使用简明教程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python-bytes-decode.html">Python 3 Bytes.decode 遇到的问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chmod-t.html">Linux粘滞位说明</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mysql-green-start.html">mysql绿色启动方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ldap.html">LDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security.html">系统安全的思考</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VPN_Advance_Options.html">VPN 高级选项那些事</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sphinx-i11n.html">sphinx 生成本地化的文档</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git-server.html">简易 git 服务器</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../quant/index.html">量化投资</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../throughts/index.html">瞎想</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">关于我</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html#id2">联系</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">qytz-notes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">技术笔记</a> &raquo;</li>
        
          <li><a href="index.html">The Python GTK+ 3 Tutorial</a> &raquo;</li>
        
      <li>Multiline Text Editor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tech/PyGObject-Tutorial/textview.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="multiline-text-editor">
<h1>Multiline Text Editor<a class="headerlink" href="#multiline-text-editor" title="永久链接至标题">¶</a></h1>
<p><a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 控件可以用来显示和编辑大量的格式化的文本。与 <a class="reference internal" href="treeview.html#Gtk.TreeView" title="Gtk.TreeView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a>
类似，其也有一个模型/视图的设计， <a class="reference internal" href="#Gtk.TextBuffer" title="Gtk.TextBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextBuffer</span></code></a> 就是代表正在被编辑的文本
的模型。模型也允许两个或更多个的 <a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 共享同一个 <a class="reference internal" href="#Gtk.TextBuffer" title="Gtk.TextBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextBuffer</span></code></a> ，
并允许这些文本有不同的显示。或者你也可以在同一个 <a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 的不同时间显示
不同 text buffer 的文本。</p>
<div class="section" id="the-view">
<h2>视图（The View）<a class="headerlink" href="#the-view" title="永久链接至标题">¶</a></h2>
<p><a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 就是用户可以添加、编辑或者删除文本的前端，其通常用来编辑
多行的文本。当创建一个 <a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 时其自动包含一个默认的 <a class="reference internal" href="#Gtk.TextBuffer" title="Gtk.TextBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextBuffer</span></code></a> ，
你可以通过 <a class="reference internal" href="#Gtk.TextView.get_buffer" title="Gtk.TextView.get_buffer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextView.get_buffer()</span></code></a> 来获取。</p>
<p>默认情况下，文本可以在 <a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 中被添加、编辑与删除，你可以通过调用
<a class="reference internal" href="#Gtk.TextView.set_editable" title="Gtk.TextView.set_editable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextView.set_editable()</span></code></a> 来禁止编辑。如果文本不可被编辑，你也通常想要使用
<a class="reference internal" href="#Gtk.TextView.set_cursor_visible" title="Gtk.TextView.set_cursor_visible"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextView.set_cursor_visible()</span></code></a> 来隐藏文本光标。在有些时候可以通过
<a class="reference internal" href="#Gtk.TextView.set_justification" title="Gtk.TextView.set_justification"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextView.set_justification()</span></code></a> 来设置文本的对齐方式很有用，文本可以显示为
左对齐(<code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.Justification.LEFT</span></code>)，右对齐(attr:<cite>Gtk.Justification.RIGHT</cite>)，或者
中间对齐(attr:<cite>Gtk.Justification.CENTER</cite>)，或者占满整行(attr:<cite>Gtk.Justification.FILL</cite>)。</p>
<p><a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 的另一项默认设置是长行会一直水平延伸知道遇到一个断行。调用
<a class="reference internal" href="#Gtk.TextView.set_wrap_mode" title="Gtk.TextView.set_wrap_mode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextView.set_wrap_mode()</span></code></a> 可以使文本自动换行一避免文本跑出屏幕边缘。</p>
<div class="section" id="textview">
<h3>TextView 对象<a class="headerlink" href="#textview" title="永久链接至标题">¶</a></h3>
<dl class="class">
<dt id="Gtk.TextView">
<em class="property">class </em><code class="descclassname">Gtk.</code><code class="descname">TextView</code><a class="headerlink" href="#Gtk.TextView" title="永久链接至目标">¶</a></dt>
<dd><p>创建一个新的 <a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 并关联一个空的 <a class="reference internal" href="#Gtk.TextBuffer" title="Gtk.TextBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextBuffer</span></code></a> 。</p>
<dl class="method">
<dt id="Gtk.TextView.get_buffer">
<code class="descname">get_buffer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextView.get_buffer" title="永久链接至目标">¶</a></dt>
<dd><p>返回 text view 正在显示的 <a class="reference internal" href="#Gtk.TextBuffer" title="Gtk.TextBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextBuffer</span></code></a> 。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextView.set_editable">
<code class="descname">set_editable</code><span class="sig-paren">(</span><em>editable</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextView.set_editable" title="永久链接至目标">¶</a></dt>
<dd><p>设置 <a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 的文本是否可编辑。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextView.set_cursor_visible">
<code class="descname">set_cursor_visible</code><span class="sig-paren">(</span><em>visible</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextView.set_cursor_visible" title="永久链接至目标">¶</a></dt>
<dd><p>设置现在光标的位置是否显示。不可编辑文本不应该有一个可见的光标，因此你
可能会关闭光标的显示。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextView.set_justification">
<code class="descname">set_justification</code><span class="sig-paren">(</span><em>justification</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextView.set_justification" title="永久链接至目标">¶</a></dt>
<dd><p>设置文本的额默认对齐方式。</p>
<p><em>justification</em> 的值可以是下列之一：</p>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.Justification.LEFT</span></code>: 文本左对齐。</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.Justification.RIGHT</span></code>: 文本右对齐。</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.Justification.CENTER</span></code>: 文本居中对齐。</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.Justification.FILL</span></code>: 文本占满整行。</p></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextView.set_wrap_mode">
<code class="descname">set_wrap_mode</code><span class="sig-paren">(</span><em>wrap_mode</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextView.set_wrap_mode" title="永久链接至目标">¶</a></dt>
<dd><p>设置view是否自动断行。</p>
<p><em>wrap_mode</em> 的值可以是下列之一：</p>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.WrapMode.NONE</span></code>: 不自动断行，文本域会一直随着文本变宽。</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.WrapMode.CHAR</span></code>: 自动断行，可以光标可以出现的地方断行（通常字符之间）。</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.WrapMode.WORD</span></code>: 自动断行，可以在单词之间断行。</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.WrapMode.WORD_CHAR</span></code>: 自动断行，可以在单词之间断行，但如果
空间不够时Wrap text, 也可以在 <a class="reference external" href="http://developer.gnome.org/pango/stable/pango-Text-Processing.html#pango-get-log-attrs">graphemes</a> 出断行。</p></li>
</ul>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="the-model">
<h2>模型（The Model）<a class="headerlink" href="#the-model" title="永久链接至标题">¶</a></h2>
<p><a class="reference internal" href="#Gtk.TextBuffer" title="Gtk.TextBuffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextBuffer</span></code></a> 是 <a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 控件的核心，用来保存
<a class="reference internal" href="#Gtk.TextView" title="Gtk.TextView"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextView</span></code></a> 显示的文本。设置和获取文本内容可以他用过
<a class="reference internal" href="#Gtk.TextBuffer.set_text" title="Gtk.TextBuffer.set_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.set_text()</span></code></a> 和 <a class="reference internal" href="#Gtk.TextBuffer.get_text" title="Gtk.TextBuffer.get_text"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextBuffer.get_text</span></code></a> 。
但是绝大多数的文本操作是通过 <em>iterators</em> 来完成的，即 <a class="reference internal" href="#Gtk.TextIter" title="Gtk.TextIter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextIter</span></code></a> 。
iterator迭代器代表了文本buffer中两个字符之间的一个位置。迭代器并不是一直有效的，
一旦文本内容被修改并影响了buffer的内容，所有的迭代去就都无效了。</p>
<p>正因为此，迭代器不能用来在buffer修改前后保留位置。要保存一个位置，使用 <a class="reference internal" href="#Gtk.TextMark" title="Gtk.TextMark"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextMark</span></code></a> 。
一个text buffer包含两个内建的标记，”insert” 标记光标的位置，”selection_bound” 标记，
可以通过 <a class="reference internal" href="#Gtk.TextBuffer.get_insert" title="Gtk.TextBuffer.get_insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.get_insert()</span></code></a> 和 <a class="reference internal" href="#Gtk.TextBuffer.get_selection_bound" title="Gtk.TextBuffer.get_selection_bound"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.get_selection_bound()</span></code></a>
来获得他们。默认 <a class="reference internal" href="#Gtk.TextMark" title="Gtk.TextMark"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextMark</span></code></a> 的位置是不显示的，可以通过
<a class="reference internal" href="#Gtk.TextMark.set_visible" title="Gtk.TextMark.set_visible"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextMark.set_visible()</span></code></a> 设置。</p>
<p>有很多方法可以获取 <a class="reference internal" href="#Gtk.TextIter" title="Gtk.TextIter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextIter</span></code></a> 。例如， <a class="reference internal" href="#Gtk.TextBuffer.get_start_iter" title="Gtk.TextBuffer.get_start_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.get_start_iter()</span></code></a>
返回只想text buffer地一个位置的迭代器，而 <a class="reference internal" href="#Gtk.TextBuffer.get_end_iter" title="Gtk.TextBuffer.get_end_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.get_end_iter()</span></code></a> 则返回
最后一个有效字符处的迭代器。获取选中文本的边界可以通过 <a class="reference internal" href="#Gtk.TextBuffer.get_selection_bounds" title="Gtk.TextBuffer.get_selection_bounds"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.get_selection_bounds()</span></code></a> 。</p>
<p>要在一个指定位置插入文本请使用 <a class="reference internal" href="#Gtk.TextBuffer.insert" title="Gtk.TextBuffer.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.insert()</span></code></a> 。另一个非常有用的方法
<a class="reference internal" href="#Gtk.TextBuffer.insert_at_cursor" title="Gtk.TextBuffer.insert_at_cursor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.insert_at_cursor()</span></code></a> 可以在光标指向的位置插入文本。要删除一部分
文本请使用 <a class="reference internal" href="#Gtk.TextBuffer.delete" title="Gtk.TextBuffer.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.delete()</span></code></a> 。</p>
<p>另外，<a class="reference internal" href="#Gtk.TextIter" title="Gtk.TextIter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextIter</span></code></a> 可以通过 <a class="reference internal" href="#Gtk.TextIter.forward_search" title="Gtk.TextIter.forward_search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextIter.forward_search()</span></code></a> 和
<a class="reference internal" href="#Gtk.TextIter.backward_search" title="Gtk.TextIter.backward_search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextIter.backward_search()</span></code></a> 用来搜索文本。根据需求可以使用buffer开始和结束
的iters来进行向前/后的搜索。</p>
<div class="section" id="textbuffer">
<h3>TextBuffer 对象<a class="headerlink" href="#textbuffer" title="永久链接至标题">¶</a></h3>
<dl class="class">
<dt id="Gtk.TextBuffer">
<em class="property">class </em><code class="descclassname">Gtk.</code><code class="descname">TextBuffer</code><a class="headerlink" href="#Gtk.TextBuffer" title="永久链接至目标">¶</a></dt>
<dd><dl class="method">
<dt id="Gtk.TextBuffer.set_text">
<code class="descname">set_text</code><span class="sig-paren">(</span><em>text</em><span class="optional">[</span>, <em>length</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.set_text" title="永久链接至目标">¶</a></dt>
<dd><p>删除buffer当前的内容，并插入 <em>length</em> 个 <em>text</em> 中的字符。
如果 <em>length</em> 为-1或忽略， <em>text</em> 全部被插入。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.get_text">
<code class="descname">get_text</code><span class="sig-paren">(</span><em>start_iter</em>, <em>end_iter</em>, <em>include_hidden_chars</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.get_text" title="永久链接至目标">¶</a></dt>
<dd><p>返回从 <em>start_iter</em> (包含)和 <em>end_iter</em> (不含)之间的文本，如果
<em>include_hidden_chars</em> 为 <code class="docutils literal notranslate"><span class="pre">False</span></code> ，则不包含未显示的文本。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.get_insert">
<code class="descname">get_insert</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.get_insert" title="永久链接至目标">¶</a></dt>
<dd><p>返回代表当前光标位置(插入点)的 <a class="reference internal" href="#Gtk.TextMark" title="Gtk.TextMark"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextMark</span></code></a> 。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.get_selection_bound">
<code class="descname">get_selection_bound</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.get_selection_bound" title="永久链接至目标">¶</a></dt>
<dd><p>返回代表选中区域边界的 <a class="reference internal" href="#Gtk.TextMark" title="Gtk.TextMark"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextMark</span></code></a> 。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.create_mark">
<code class="descname">create_mark</code><span class="sig-paren">(</span><em>mark_name</em>, <em>where</em><span class="optional">[</span>, <em>left_gravity</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.create_mark" title="永久链接至目标">¶</a></dt>
<dd><p>在 <a class="reference internal" href="#Gtk.TextIter" title="Gtk.TextIter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextIter</span></code></a> <em>where</em> 处创建一个 <a class="reference internal" href="#Gtk.TextMark" title="Gtk.TextMark"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextMark</span></code></a> 。
如果 <em>mark_name</em> 为 <code class="docutils literal notranslate"><span class="pre">None</span></code> ，则mark是匿名的。如果一个标记有left_gravity，
文本被插入到当前位置后，标记会移动到新插入文本的左边。如果标记为right_gravity
(<em>left_gravity</em> 为 <code class="docutils literal notranslate"><span class="pre">False</span></code>)，标记会移动到新插入文本的右边。因此标准的
从左到右的光标为right gravity的标记（当你输入的时候，光标会出现在你输入文本的右边）。</p>
<p>如果 <em>left_gravity</em> 被忽略，默认为 <code class="docutils literal notranslate"><span class="pre">False</span></code> 。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.get_mark">
<code class="descname">get_mark</code><span class="sig-paren">(</span><em>mark_name</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.get_mark" title="永久链接至目标">¶</a></dt>
<dd><p>返回buffer中名字为mark_name的 :class`Gtk.TextMark` ，如果不存在则返回 <code class="docutils literal notranslate"><span class="pre">None</span></code> 。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.get_start_iter">
<code class="descname">get_start_iter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.get_start_iter" title="永久链接至目标">¶</a></dt>
<dd><p>返回指向buffer地一个位置的 <a class="reference internal" href="#Gtk.TextIter" title="Gtk.TextIter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextIter</span></code></a> 。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.get_end_iter">
<code class="descname">get_end_iter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.get_end_iter" title="永久链接至目标">¶</a></dt>
<dd><p>返回只想buffer最后一个有效字符的 <a class="reference internal" href="#Gtk.TextIter" title="Gtk.TextIter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextIter</span></code></a> 。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.get_selection_bounds">
<code class="descname">get_selection_bounds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.get_selection_bounds" title="永久链接至目标">¶</a></dt>
<dd><p>返回包含两个 <a class="reference internal" href="#Gtk.TextIter" title="Gtk.TextIter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextIter</span></code></a> tuple对象，分别指向选中的第一个字符和
后不第一个未选中的字符。如果没有文本被选中则返回空的tuple。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.insert">
<code class="descname">insert</code><span class="sig-paren">(</span><em>text_iter</em>, <em>text</em><span class="optional">[</span>, <em>length</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.insert" title="永久链接至目标">¶</a></dt>
<dd><p>在 <em>text_iter</em> 处插入 <em>text</em> 的 <em>length</em> 个字符。如果 <em>length</em> 为-1或忽略，
全部的 <em>text</em> 会被插入。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.insert_at_cursor">
<code class="descname">insert_at_cursor</code><span class="sig-paren">(</span><em>text</em><span class="optional">[</span>, <em>length</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.insert_at_cursor" title="永久链接至目标">¶</a></dt>
<dd><p><a class="reference internal" href="#Gtk.TextBuffer.insert" title="Gtk.TextBuffer.insert"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert()</span></code></a> 的简单调用，使用光标位置作为插入点。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><em>start_iter</em>, <em>end_iter</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.delete" title="永久链接至目标">¶</a></dt>
<dd><p>删除 <em>start_iter</em> 与 <em>end_iter</em> 之间的文本。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.create_tag">
<code class="descname">create_tag</code><span class="sig-paren">(</span><em>tag_name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.create_tag" title="永久链接至目标">¶</a></dt>
<dd><p>创建一个tag并添加到buffer的tag表中。</p>
<p>如果 <em>tag_name</em> 为 <code class="docutils literal notranslate"><span class="pre">None</span></code> ，则tag是匿名的，否则tag_name不能与tag表中
已经存在的tag重名。</p>
<p><em>kwargs</em> 为任意数量的键值对，代表了tag的属性列表，可以通过 <code class="docutils literal notranslate"><span class="pre">tag.set_property</span></code> 来设置。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.apply_tag">
<code class="descname">apply_tag</code><span class="sig-paren">(</span><em>tag</em>, <em>start_iter</em>, <em>end_iter</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.apply_tag" title="永久链接至目标">¶</a></dt>
<dd><p>应用 <em>tag</em> 到给定范围的文本。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.remove_tag">
<code class="descname">remove_tag</code><span class="sig-paren">(</span><em>tag</em>, <em>start_iter</em>, <em>end_iter</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.remove_tag" title="永久链接至目标">¶</a></dt>
<dd><p>删除给定范围内所有的 <em>tag</em> 。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextBuffer.remove_all_tags">
<code class="descname">remove_all_tags</code><span class="sig-paren">(</span><em>start_iter</em>, <em>end_iter</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextBuffer.remove_all_tags" title="永久链接至目标">¶</a></dt>
<dd><p>删除给定范围内所有的tag。</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Gtk.TextIter">
<em class="property">class </em><code class="descclassname">Gtk.</code><code class="descname">TextIter</code><a class="headerlink" href="#Gtk.TextIter" title="永久链接至目标">¶</a></dt>
<dd><dl class="method">
<dt id="Gtk.TextIter.forward_search">
<code class="descname">forward_search</code><span class="sig-paren">(</span><em>needle</em>, <em>flags</em>, <em>limit</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextIter.forward_search" title="永久链接至目标">¶</a></dt>
<dd><p>向前搜索 <em>needle</em> 。搜索在达到limit后不会再继续。</p>
<p><em>flags</em> 可以为下列之一，或者他们的组合（通过或操作符 <code class="docutils literal notranslate"><span class="pre">|</span></code> ）。</p>
<ul class="simple">
<li><p>0: 精确匹配</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.TextSearchFlags.VISIBLE_ONLY</span></code>: 匹配可能在 <em>needle</em> 中间穿插
有不可见字符，即 <em>needle</em> 为匹配到的字符串的可能不连续的子序列。</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.TextSearchFlags.TEXT_ONLY</span></code>: 匹配可能包含图像pixbuf或者子空间
混合在匹配到的范围内。</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.TextSearchFlags.CASE_INSENSITIVE</span></code>: 匹配忽略大小写。</p></li>
</ul>
<p>返回包含指向开始与匹配到的文本后边的 <a class="reference internal" href="#Gtk.TextIter" title="Gtk.TextIter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextIter</span></code></a> 的元组。如果
没有找到，则返回 <code class="docutils literal notranslate"><span class="pre">None</span></code> 。</p>
</dd></dl>

<dl class="method">
<dt id="Gtk.TextIter.backward_search">
<code class="descname">backward_search</code><span class="sig-paren">(</span><em>needle</em>, <em>flags</em>, <em>limit</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextIter.backward_search" title="永久链接至目标">¶</a></dt>
<dd><p>与 <a class="reference internal" href="#Gtk.TextIter.forward_search" title="Gtk.TextIter.forward_search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward_search()</span></code></a> 相同，但是向后搜索。</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Gtk.TextMark">
<em class="property">class </em><code class="descclassname">Gtk.</code><code class="descname">TextMark</code><a class="headerlink" href="#Gtk.TextMark" title="永久链接至目标">¶</a></dt>
<dd><dl class="method">
<dt id="Gtk.TextMark.set_visible">
<code class="descname">set_visible</code><span class="sig-paren">(</span><em>visible</em><span class="sig-paren">)</span><a class="headerlink" href="#Gtk.TextMark.set_visible" title="永久链接至目标">¶</a></dt>
<dd><p>设置标记的可见性。插入点通常是可见的，即你可以看到一个竖直的光标条；而且，
text控件也会使用一个可见的标记来指示拖拽操作的释放点。绝大多数其他的比较
是不可见的。标记默认是不可见的。</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="tags">
<h2>Tags<a class="headerlink" href="#tags" title="永久链接至标题">¶</a></h2>
<p>buffer内的文本可以通过tag来标记。tag就是一个可以应用到一个文本范围的属性。例如，
“bold” tag使应用到文本加粗。然而tag的概念比其更多，tag不一定会影响外观，也可能会
影响鼠标和按键的行为，”lock” 可以锁定一段文本使用户不能编辑，或者数不尽的其他的事情。
tag由 <code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextTag</span></code> 对象代表。一个 <code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextTag</span></code> 可以应用到任何数量
的文本范围，任何数量的buffer。</p>
<p>所有的tag都存储在 <code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TextTagTable</span></code> 中。一个tab表定义了一系列的tag并可以一起使用。
每一个buffer都有一个与之关联的tag表，只有表中的tag才可以应用到buffer。但一个tag表可以
在多个buffer间共享。</p>
<p>要指定buffer内的一部分为本应该有特定的格式，你必须先定义该格式的tag，然后使用
<a class="reference internal" href="#Gtk.TextBuffer.create_tag" title="Gtk.TextBuffer.create_tag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.create_tag()</span></code></a> 和 <a class="reference internal" href="#Gtk.TextBuffer.apply_tag" title="Gtk.TextBuffer.apply_tag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.apply_tag()</span></code></a> 来将tag应用到文本区域。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tag</span> <span class="o">=</span> <span class="n">textbuffer</span><span class="o">.</span><span class="n">create_tag</span><span class="p">(</span><span class="s2">&quot;orange_bg&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">textbuffer</span><span class="o">.</span><span class="n">apply_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">start_iter</span><span class="p">,</span> <span class="n">end_iter</span><span class="p">)</span>
</pre></div>
</div>
<p>以下列出一些应用到文本的通常使用的风格：</p>
<blockquote>
<div><ul class="simple">
<li><p>背景颜色(“foreground” property)</p></li>
<li><p>前景颜色(“background” property)</p></li>
<li><p>下划线(“underline” property)</p></li>
<li><p>粗体(“weight” property)</p></li>
<li><p>斜提(“style” property)</p></li>
<li><p>删除线(“strikethrough” property)</p></li>
<li><p>对齐(“justification” property)</p></li>
<li><p>大小(“size” and “size-points” properties)</p></li>
<li><p>自动换行(“wrap-mode” property)</p></li>
</ul>
</div></blockquote>
<p>你也可以使用 <a class="reference internal" href="#Gtk.TextBuffer.remove_tag" title="Gtk.TextBuffer.remove_tag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.remove_tag()</span></code></a> 删除某个特定的tag，或者使用
<a class="reference internal" href="#Gtk.TextBuffer.remove_all_tags" title="Gtk.TextBuffer.remove_all_tags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TextBuffer.remove_all_tags()</span></code></a> 删除给的区域所有的tag。</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="永久链接至标题">¶</a></h2>
<img alt="../../_images/textview_example.png" src="../../_images/textview_example.png" />
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gi.repository</span> <span class="k">import</span> <span class="n">Gtk</span><span class="p">,</span> <span class="n">Pango</span>

<span class="k">class</span> <span class="nc">SearchDialog</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Dialog</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="n">Gtk</span><span class="o">.</span><span class="n">Dialog</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Search&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span>
                <span class="n">Gtk</span><span class="o">.</span><span class="n">DialogFlags</span><span class="o">.</span><span class="n">MODAL</span><span class="p">,</span> <span class="n">buttons</span><span class="o">=</span><span class="p">(</span>
                    <span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_FIND</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">OK</span><span class="p">,</span>
                    <span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_CANCEL</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">))</span>

        <span class="n">box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_content_area</span><span class="p">()</span>

        <span class="n">label</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s1">&#39;Insert text you want to search for:&#39;</span><span class="p">)</span>
        <span class="n">box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Entry</span><span class="p">()</span>
        <span class="n">box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">TextViewWindow</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Window</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Gtk</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;TextView Demo&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_default_size</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">350</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Grid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">create_textview</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_toolbar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_buttons</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_toolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">toolbar</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Toolbar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">toolbar</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">button_bold</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ToolButton</span><span class="o">.</span><span class="n">new_from_stock</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_BOLD</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">button_bold</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">button_italic</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ToolButton</span><span class="o">.</span><span class="n">new_from_stock</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_ITALIC</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">button_italic</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">button_underline</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ToolButton</span><span class="o">.</span><span class="n">new_from_stock</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_UNDERLINE</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">button_underline</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">button_bold</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_button_clicked</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag_bold</span><span class="p">)</span>
        <span class="n">button_italic</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_button_clicked</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag_italic</span><span class="p">)</span>
        <span class="n">button_underline</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_button_clicked</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag_underline</span><span class="p">)</span>

        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">SeparatorToolItem</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>

        <span class="n">radio_justifyleft</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">RadioToolButton</span><span class="p">()</span>
        <span class="n">radio_justifyleft</span><span class="o">.</span><span class="n">set_stock_id</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_JUSTIFY_LEFT</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">radio_justifyleft</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

        <span class="n">radio_justifycenter</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">RadioToolButton</span><span class="o">.</span><span class="n">new_with_stock_from_widget</span><span class="p">(</span>
                <span class="n">radio_justifyleft</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_JUSTIFY_CENTER</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">radio_justifycenter</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="n">radio_justifyright</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">RadioToolButton</span><span class="o">.</span><span class="n">new_with_stock_from_widget</span><span class="p">(</span>
                <span class="n">radio_justifyleft</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_JUSTIFY_RIGHT</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">radio_justifyright</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

        <span class="n">radio_justifyfill</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">RadioToolButton</span><span class="o">.</span><span class="n">new_with_stock_from_widget</span><span class="p">(</span>
                <span class="n">radio_justifyleft</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_JUSTIFY_FILL</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">radio_justifyfill</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">radio_justifyleft</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;toggled&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_justify_toggled</span><span class="p">,</span>
                <span class="n">Gtk</span><span class="o">.</span><span class="n">Justification</span><span class="o">.</span><span class="n">LEFT</span><span class="p">)</span>
        <span class="n">radio_justifycenter</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;toggled&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_justify_toggled</span><span class="p">,</span>
                <span class="n">Gtk</span><span class="o">.</span><span class="n">Justification</span><span class="o">.</span><span class="n">CENTER</span><span class="p">)</span>
        <span class="n">radio_justifyright</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;toggled&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_justify_toggled</span><span class="p">,</span>
                <span class="n">Gtk</span><span class="o">.</span><span class="n">Justification</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
        <span class="n">radio_justifyfill</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;toggled&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_justify_toggled</span><span class="p">,</span>
                <span class="n">Gtk</span><span class="o">.</span><span class="n">Justification</span><span class="o">.</span><span class="n">FILL</span><span class="p">)</span>

        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">SeparatorToolItem</span><span class="p">(),</span> <span class="mi">8</span><span class="p">)</span>

        <span class="n">button_clear</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ToolButton</span><span class="o">.</span><span class="n">new_from_stock</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_CLEAR</span><span class="p">)</span>
        <span class="n">button_clear</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_clear_clicked</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">button_clear</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">SeparatorToolItem</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">button_search</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ToolButton</span><span class="o">.</span><span class="n">new_from_stock</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">STOCK_FIND</span><span class="p">)</span>
        <span class="n">button_search</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;clicked&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_search_clicked</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">button_search</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_textview</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">scrolledwindow</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ScrolledWindow</span><span class="p">()</span>
        <span class="n">scrolledwindow</span><span class="o">.</span><span class="n">set_hexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">scrolledwindow</span><span class="o">.</span><span class="n">set_vexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">scrolledwindow</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">textview</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TextView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textview</span><span class="o">.</span><span class="n">get_buffer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;This is some text inside a Gtk.TextView. &#39;</span>
                <span class="o">+</span> <span class="s1">&#39;Select text and click one of the buttons &quot;bold&quot;, &quot;italic&quot;, &#39;</span>
                <span class="o">+</span> <span class="s1">&#39;or &quot;underline&quot; to modify the text accordingly.&#39;</span><span class="p">)</span>
        <span class="n">scrolledwindow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">textview</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tag_bold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">create_tag</span><span class="p">(</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                <span class="n">weight</span><span class="o">=</span><span class="n">Pango</span><span class="o">.</span><span class="n">Weight</span><span class="o">.</span><span class="n">BOLD</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag_italic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">create_tag</span><span class="p">(</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="n">Pango</span><span class="o">.</span><span class="n">Style</span><span class="o">.</span><span class="n">ITALIC</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag_underline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">create_tag</span><span class="p">(</span><span class="s1">&#39;underline&#39;</span><span class="p">,</span>
                <span class="n">underline</span><span class="o">=</span><span class="n">Pango</span><span class="o">.</span><span class="n">Underline</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag_found</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">create_tag</span><span class="p">(</span><span class="s1">&#39;found&#39;</span><span class="p">,</span>
                <span class="n">background</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">check_editable</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CheckButton</span><span class="p">(</span><span class="s1">&#39;Editable&#39;</span><span class="p">)</span>
        <span class="n">check_editable</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">check_editable</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;toggled&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_editable_toggled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">check_editable</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">check_cursor</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CheckButton</span><span class="p">(</span><span class="s1">&#39;Cursor Visible&#39;</span><span class="p">)</span>
        <span class="n">check_cursor</span><span class="o">.</span><span class="n">set_active</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">check_cursor</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;toggled&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_cursor_toggled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach_next_to</span><span class="p">(</span><span class="n">check_cursor</span><span class="p">,</span> <span class="n">check_editable</span><span class="p">,</span>
                <span class="n">Gtk</span><span class="o">.</span><span class="n">PositionType</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">radio_wrapnone</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">RadioButton</span><span class="o">.</span><span class="n">new_with_label_from_widget</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;No Wrapping&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">radio_wrapnone</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">radio_wrapchar</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">RadioButton</span><span class="o">.</span><span class="n">new_with_label_from_widget</span><span class="p">(</span>
                <span class="n">radio_wrapnone</span><span class="p">,</span><span class="s1">&#39;Character Wrapping&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach_next_to</span><span class="p">(</span><span class="n">radio_wrapchar</span><span class="p">,</span> <span class="n">radio_wrapnone</span><span class="p">,</span>
                <span class="n">Gtk</span><span class="o">.</span><span class="n">PositionType</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">radio_wrapword</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">RadioButton</span><span class="o">.</span><span class="n">new_with_label_from_widget</span><span class="p">(</span>
                <span class="n">radio_wrapnone</span><span class="p">,</span> <span class="s1">&#39;Word Wrapping&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach_next_to</span><span class="p">(</span><span class="n">radio_wrapword</span><span class="p">,</span> <span class="n">radio_wrapchar</span><span class="p">,</span>
                <span class="n">Gtk</span><span class="o">.</span><span class="n">PositionType</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">radio_wrapnone</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;toggled&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_wrap_toggled</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">NONE</span><span class="p">)</span>
        <span class="n">radio_wrapchar</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;toggled&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_wrap_toggled</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">CHAR</span><span class="p">)</span>
        <span class="n">radio_wrapword</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;toggled&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_wrap_toggled</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">WrapMode</span><span class="o">.</span><span class="n">WORD</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">get_selection_bounds</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">bounds</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">apply_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_clear_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">get_start_iter</span><span class="p">()</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">get_end_iter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">remove_all_tags</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_editable_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textview</span><span class="o">.</span><span class="n">set_editable</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">get_active</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">on_cursor_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textview</span><span class="o">.</span><span class="n">set_cursor_visible</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">get_active</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">on_wrap_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textview</span><span class="o">.</span><span class="n">set_wrap_mode</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_justify_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">justification</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">textview</span><span class="o">.</span><span class="n">set_justification</span><span class="p">(</span><span class="n">justification</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_search_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">SearchDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ResponseType</span><span class="o">.</span><span class="n">OK</span><span class="p">:</span>
            <span class="n">cursor_mark</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">get_insert</span><span class="p">()</span>
            <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">get_iter_at_mark</span><span class="p">(</span><span class="n">cursor_mark</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">start</span><span class="o">.</span><span class="n">get_offset</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">get_char_count</span><span class="p">():</span>
                <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">get_start_iter</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">search_and_mark</span><span class="p">(</span><span class="n">dialog</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">get_text</span><span class="p">(),</span> <span class="n">start</span><span class="p">)</span>

        <span class="n">dialog</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">search_and_mark</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">get_end_iter</span><span class="p">()</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">forward_search</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">match</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">match_start</span><span class="p">,</span> <span class="n">match_end</span> <span class="o">=</span> <span class="n">match</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">textbuffer</span><span class="o">.</span><span class="n">apply_tag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tag_found</span><span class="p">,</span> <span class="n">match_start</span><span class="p">,</span> <span class="n">match_end</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">search_and_mark</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">match_end</span><span class="p">)</span>

<span class="n">win</span> <span class="o">=</span> <span class="n">TextViewWindow</span><span class="p">()</span>
<span class="n">win</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;delete-event&#39;</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">main_quit</span><span class="p">)</span>
<span class="n">win</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>
<span class="n">Gtk</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="menus.html" class="btn btn-neutral float-right" title="菜单" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="iconview.html" class="btn btn-neutral float-left" title="IconView" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, qytz(lennyh)
      <span class="lastupdated">
        最后更新于 2019 年 05 月 17 日.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>